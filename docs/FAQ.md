# ❓ Частые вопросы

## Не приходят уведомления

**Проверьте:**
- Включены ли уведомления (зеленый индикатор в popup)
- Правильно ли настроены GitLab и Telegram
- Выбраны ли проекты для мониторинга
- Есть ли новая активность в GitLab

**Решение:** Нажмите "Проверить сейчас" в popup

## Ошибка "GitLab API Error: 401"

**Причина:** Неправильный токен или недостаточно прав

**Решение:**
1. Создайте новый токен в GitLab
2. Убедитесь, что выбрано право `api` ✅ (именно `api`, а не `read_api`!)

## Ошибка "Telegram API Error"

**Причина:** Неправильный Bot Token или Chat ID

**Решение:**
1. Проверьте Bot Token от [@BotFather](https://t.me/BotFather)
2. Проверьте Chat ID от [@userinfobot](https://t.me/userinfobot)
3. Убедитесь, что написали боту хотя бы одно сообщение

## Ошибка "chat not found" в Telegram

**Причина:** Бот не может найти чат или вы не написали боту первое сообщение

**Решение:**
1. **ВАЖНО:** Найдите вашего бота в Telegram и нажмите "Start" или напишите любое сообщение
   - Telegram не позволяет ботам писать первыми!
2. Проверьте правильность Chat ID через API: откройте в браузере `https://api.telegram.org/bot<BOT_TOKEN>/getUpdates`
   - Замените `<BOT_TOKEN>` на ваш токен бота
   - В ответе найдите `"chat":{"id":123456789}` - это ваш Chat ID
3. Убедитесь, что Chat ID - просто число (например: `123456789` или отрицательное для групп `-123456789`)
4. Для групп/каналов: добавьте бота как администратора с правами отправки сообщений

## Как узнать Chat ID в Telegram?

**Способ 1:** [@userinfobot](https://t.me/userinfobot) → Start

**Способ 2:**
1. Напишите боту сообщение
2. Откройте: `https://api.telegram.org/bot<BOT_TOKEN>/getUpdates`
3. Найдите `"chat":{"id":123456789}`

## Как создать Personal Access Token в GitLab?

1. GitLab → Settings → Access Tokens → Personal Access Tokens
2. Token name: `Chrome Notifier` (или любое другое имя)
3. Expiration date: выберите срок действия (рекомендуется год или без срока)
4. Select scopes: **только `api`** ✅ (именно `api`)
   - Этот scope дает доступ к чтению MR, комментариев, пайплайнов и пользовательских данных
5. Create personal access token → скопируйте токен (больше не покажется!)

## CORS ошибка при запросах к GitLab

**Для администратора GitLab:**

Добавьте в `/etc/gitlab/gitlab.rb`:
```ruby
nginx['custom_gitlab_server_config'] = "
  add_header 'Access-Control-Allow-Origin' '*' always;
"
```

Затем: `gitlab-ctl reconfigure`

## Как часто проверяется GitLab?

По умолчанию каждые 2 минут. Можно изменить в настройках (1-60 минут).

## Можно ли отслеживать несколько проектов?

Да! В настройках выберите все нужные проекты.

## Расширение не загружается в Chrome

**Проверьте:**
- Chrome версии 88 или новее (Manifest V3 требует Chrome 88+)
- Developer mode включен в `chrome://extensions/`
- Файл `icon.png` создан в папке `assets/icons/` (минимум 48×48 пикселей)
- Все файлы проекта на месте (особенно `manifest.json` и папка `src/`)
- В консоли Chrome (`chrome://extensions/` → Errors) нет ошибок загрузки

**Типичные ошибки:**
- "Failed to load icon" - отсутствует файл `assets/icons/icon.png`
- "Service worker registration failed" - проверьте файл `src/background.js` и импорты модулей

## Где посмотреть логи?

1. `chrome://extensions/`
2. GitLab Notifier → Details
3. Inspect views → service worker
4. Откроется DevTools с логами

## Автоматическая проверка не работает

**Проверьте:**
1. Откройте `chrome://extensions/` → найдите **GitLab Notifier** → кликните **Details**
2. В разделе "Inspect views" кликните **service worker** - откроется консоль DevTools
3. В консоли должны появляться периодические сообщения: 
   - `"⏰ Alarm сработал, запускаем проверку GitLab"`
   - `"=== Начало проверки GitLab ==="`
4. Проверьте интервал в настройках расширения (1-60 минут)
5. Убедитесь, что уведомления включены (зеленый индикатор в popup)

**Если alarm не срабатывает:**
1. Перезагрузите расширение: `chrome://extensions/` → кнопка ⟳ (обновить)
2. Проверьте в консоли service worker: должно быть сообщение `"Alarm настроен на X минут с немедленным первым запуском"`
3. Chrome может приостанавливать расширения при неактивности - откройте popup или используйте кнопку "Проверить сейчас"
4. Service worker Chrome работает не всегда идеально - рекомендуется держать открытой вкладку с GitLab или периодически открывать popup расширения
